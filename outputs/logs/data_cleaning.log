2025-11-02 22:07:01 - root - INFO - 開始執行資料清理腳本...
2025-11-02 22:07:01 - DataLoader - INFO - ============================================================
2025-11-02 22:07:01 - DataLoader - INFO - 檢查資料檔案...
2025-11-02 22:07:01 - DataLoader - INFO - ============================================================
2025-11-02 22:07:01 - DataLoader - INFO - SharedResponsesSurvey.csv                ✅ 存在
2025-11-02 22:07:01 - DataLoader - INFO - CountriesChangePr.csv                    ✅ 存在
2025-11-02 22:07:01 - DataLoader - INFO - country_cluster_map.csv                  ✅ 存在
2025-11-02 22:07:01 - DataLoader - INFO - moral_distance.csv                       ✅ 存在
2025-11-02 22:07:01 - DataLoader - INFO - dendrogram_Culture.csv                   ✅ 存在
2025-11-02 22:07:01 - DataLoader - INFO - 
載入中: SharedResponsesSurvey.csv
2025-11-02 22:07:36 - DataLoader - INFO - ✅ 成功載入 11,286,141 行 × 27 欄
2025-11-02 22:07:36 - DataLoader - INFO -    ✓ 所有關鍵欄位都存在
2025-11-02 22:07:36 - DataLoader - INFO - 
載入中: country_cluster_map.csv
2025-11-02 22:07:36 - DataLoader - INFO - ✅ 成功載入 130 個國家的文化圈分類
2025-11-02 22:07:36 - DataLoader - INFO -    Cluster 0: 67 個國家
2025-11-02 22:07:36 - DataLoader - INFO -    Cluster 1: 28 個國家
2025-11-02 22:07:36 - DataLoader - INFO -    Cluster 2: 35 個國家
2025-11-02 22:07:36 - DataCleaner - INFO - 
============================================================
2025-11-02 22:07:36 - DataCleaner - INFO - 開始資料清理流程...
2025-11-02 22:07:36 - DataCleaner - INFO - ============================================================
2025-11-02 22:07:36 - DataCleaner - INFO - 原始資料: 11,286,141 行
2025-11-02 22:07:36 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:36 - DataCleaner - INFO - 【Step 1】處理關鍵變數缺失
2025-11-02 22:07:36 - DataCleaner - INFO - ------------------------------------------------------------
2025-11-02 22:07:37 - DataCleaner - INFO -   UserCountry3 缺失: 41,641 行
2025-11-02 22:07:40 - DataCleaner - INFO - 
✅ 刪除 41,641 行 (0.37%)
2025-11-02 22:07:40 - DataCleaner - INFO -    剩餘 11,244,500 行
2025-11-02 22:07:40 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:40 - DataCleaner - INFO - 【Step 2】處理異常值
2025-11-02 22:07:40 - DataCleaner - INFO - ------------------------------------------------------------
2025-11-02 22:07:41 - DataCleaner - INFO -   年齡超出範圍 [18, 75]: 2,753,581 行
2025-11-02 22:07:41 - DataCleaner - INFO -   宗教程度超出範圍 [0, 1]: 20 行
2025-11-02 22:07:44 - DataCleaner - INFO - 
✅ 刪除 2,753,601 行異常值 (24.49%)
2025-11-02 22:07:44 - DataCleaner - INFO -    剩餘 8,490,899 行
2025-11-02 22:07:44 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:44 - DataCleaner - INFO - 【Step 3】篩選「守法vs.效益」衝突情境
2025-11-02 22:07:44 - DataCleaner - INFO - ------------------------------------------------------------
2025-11-02 22:07:45 - DataCleaner - INFO -   條件1 - Utilitarian場景: 1,531,434 行
2025-11-02 22:07:45 - DataCleaner - INFO -   條件2 - 有法律考量: 3,351,948 行
2025-11-02 22:07:45 - DataCleaner - INFO -   條件3 - 人數有差異: 2,065,932 行
2025-11-02 22:07:45 - DataCleaner - INFO - 
✅ 保留 594,175 行 (7.00%)
2025-11-02 22:07:45 - DataCleaner - INFO -    過濾 7,896,724 行
2025-11-02 22:07:45 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:45 - DataCleaner - INFO - 【Step 4】檢查場景完整性
2025-11-02 22:07:45 - DataCleaner - INFO - ------------------------------------------------------------
2025-11-02 22:07:46 - DataCleaner - INFO -   發現 216583 個不完整場景
2025-11-02 22:07:46 - DataCleaner - INFO -   （涉及 216,583 行資料）
2025-11-02 22:07:46 - DataCleaner - INFO - 
✅ 刪除 216,583 行不完整場景 (36.45%)
2025-11-02 22:07:46 - DataCleaner - INFO -    剩餘 377,592 行
2025-11-02 22:07:46 - DataCleaner - INFO -    完整場景數: 188,796
2025-11-02 22:07:46 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:46 - DataCleaner - INFO - 【Step 5】合併文化圈分類
2025-11-02 22:07:46 - DataCleaner - INFO - ------------------------------------------------------------
2025-11-02 22:07:46 - DataCleaner - WARNING -   ⚠️  476 行無法對應到文化圈 (0.13%)
2025-11-02 22:07:46 - DataCleaner - INFO - 
  文化圈分佈:
2025-11-02 22:07:46 - DataCleaner - INFO -     Unclassified: 476 行 (0.1%)
2025-11-02 22:07:46 - DataCleaner - INFO -     Western: 278,830 行 (73.8%)
2025-11-02 22:07:46 - DataCleaner - INFO -     Eastern: 29,748 行 (7.9%)
2025-11-02 22:07:46 - DataCleaner - INFO -     Southern: 68,538 行 (18.2%)
2025-11-02 22:07:46 - DataCleaner - INFO - 
✅ 合併完成，維持 377,592 行
2025-11-02 22:07:47 - DataCleaner - INFO - 
============================================================
2025-11-02 22:07:47 - DataCleaner - INFO - 資料清理完成摘要
2025-11-02 22:07:47 - DataCleaner - INFO - ============================================================
2025-11-02 22:07:47 - DataCleaner - INFO - 
【原始資料】11,286,141 行
2025-11-02 22:07:47 - DataCleaner - INFO - 
【remove_missing_key_vars】
2025-11-02 22:07:47 - DataCleaner - INFO -   刪除: 41,641 行 (0.37%)
2025-11-02 22:07:47 - DataCleaner - INFO -   剩餘: 11,244,500 行
2025-11-02 22:07:47 - DataCleaner - INFO - 
【remove_outliers】
2025-11-02 22:07:47 - DataCleaner - INFO -   刪除: 2,753,601 行 (24.49%)
2025-11-02 22:07:47 - DataCleaner - INFO -   剩餘: 8,490,899 行
2025-11-02 22:07:47 - DataCleaner - INFO - 
【filter_law_vs_utility】
2025-11-02 22:07:47 - DataCleaner - INFO -   刪除: 7,896,724 行 (N/A)
2025-11-02 22:07:47 - DataCleaner - INFO -   剩餘: 594,175 行
2025-11-02 22:07:47 - DataCleaner - INFO - 
【check_completeness】
2025-11-02 22:07:47 - DataCleaner - INFO -   刪除: 216,583 行 (36.45%)
2025-11-02 22:07:47 - DataCleaner - INFO -   剩餘: 377,592 行
2025-11-02 22:07:47 - DataCleaner - INFO -   完整場景數: 188,796
2025-11-02 22:07:47 - DataCleaner - INFO - 
【merge_cluster】
2025-11-02 22:07:47 - DataCleaner - INFO -   剩餘: 377,592 行
2025-11-02 22:07:47 - DataCleaner - INFO -   未分類國家: 476 行 (標註為 Cluster=-1)
2025-11-02 22:07:47 - DataCleaner - INFO - 
------------------------------------------------------------
2025-11-02 22:07:47 - DataCleaner - INFO - 【最終結果】
2025-11-02 22:07:47 - DataCleaner - INFO -   原始資料: 11,286,141 行
2025-11-02 22:07:47 - DataCleaner - INFO -   清理後: 377,592 行
2025-11-02 22:07:47 - DataCleaner - INFO -   保留比例: 3.35%
2025-11-02 22:07:47 - DataCleaner - INFO - ============================================================

2025-11-02 22:07:50 - root - INFO - 資料清理腳本執行完成
